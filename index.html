<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OMNIcheck Installation Wizard</title>
  <style>
    :root { --welcome-bg: rgb(142,150,157); --blue:#0078d7; }
    body { font-family: Arial, sans-serif; margin:0; background:#f9f9fb; color:#333; }

    /* Welcome (unchanged, optional) */
    #welcome{ min-height:100vh; display:grid; place-items:center; padding:24px; text-align:center; background:var(--welcome-bg); }
    #welcome h1, #welcome p{ color:#fff; }
    .logo-anim{ width:clamp(360px,70vw,900px); height:auto; border-radius:16px; margin:0 0 16px; }
    .start-btn{ margin-top:16px; padding:12px 30px; border:none; border-radius:50px; background:#fff; color:var(--welcome-bg); cursor:pointer; }
/*Contact Card*/
#contactSection {
  display: none;                 /* hidden unless active */
}
#contactSection.active {
  display: block;
}
#contactSection .step.active {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 60vh;
}

/* Blue card + buttons only in Contact */
#contactSection .contact-card{
  text-align:center;
  padding:30px;
  background:#f5f9ff;
  border:1px solid #cfe3ff;
  border-radius:16px;
  box-shadow:0 4px 16px rgba(0,0,0,0.1);
}
#contactSection .contact-links{
  display:flex;
  flex-direction:column;
  gap:20px;
  margin:24px 0;
  align-items:center;
}
#contactSection .contact-links a{
  display:inline-block;
  background:linear-gradient(135deg, #0078d7, #005bb5);
  color:#fff !important;
  padding:10px 22px;
  border-radius:30px;
  text-decoration:none;
  font-weight:600;
  transition:transform .2s, background .3s;
}
#contactSection .contact-links a:hover{
  transform:scale(1.05);
  background:linear-gradient(135deg, #005bb5, #004799);
}
    /*Legacy Section*/
    /* Screenshots only inside the Legacy section */
#legacySection .screenshot{
  margin: 12px 0;
  display: flex;
  justify-content: center;
}
#legacySection .screenshot img{
  max-width: 100%;
  max-height: 48vh;   /* keeps buttons in view */
  border-radius: 8px;
  object-fit: contain; /* never crop */
}
@media (max-width: 768px){
  #legacySection .screenshot img{ max-height: 38vh; }
}

    /* Pre-Installation Warning Card */
#preinstallSection {
  display: none; /* hidden by default unless active */
}

#preinstallSection.active {
  display: block;
}

#preinstallSection .warning-card {
  background: #fff4e5;
  border: 2px solid #ffb84d;
  border-radius: 16px;
  padding: 30px;
  text-align: left;
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
}

#preinstallSection .warning-card h2 {
  color: #b22222;
  text-align: center;
  margin-bottom: 16px;
}

#preinstallSection ul {
  margin: 16px 0;
  padding-left: 24px;
}

#preinstallSection li {
  margin-bottom: 10px;
  font-size: 15px;
  line-height: 1.4;
}


    /* Wizard card */
    .wizard{ max-width:900px; margin:40px auto; background:#fff; padding:30px; border-radius:16px; box-shadow:0 4px 20px rgba(0,0,0,.1); display:none; }
    .wizard-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
    .logo-inline {
  height: auto;
  width: 150px;      
}
    .wizard-header {
  position: relative;
}


    /* Tabs */
    .section-tabs{ display:flex; gap:8px; margin:6px 0 14px; flex-wrap:wrap; }
    .tab{ padding:10px 16px; border-radius:999px; border:2px solid var(--blue); background:#fff; color:var(--blue); cursor:pointer; font-weight:600; transition:.2s; }
    .tab.active{ background:var(--blue); color:#fff; }

    /* Progress */
    .progress{ height:8px; background:#eee; border-radius:4px; margin-bottom:20px; }
    .progress-bar{ height:8px; background:var(--blue); width:0; transition:width .3s; }

    /* Sections & steps */
    .section{ display:none; }
    .section.active{ display:block; }
    .step{ display:none; animation:fadeIn .3s; }
    .step.active{ display:block; }
    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

    .screenshot{ margin:16px 0; display:flex; justify-content:center; }
    .screenshot img{ max-width:100%; border-radius:8px; }

/* ───────── ONE-FRAME CROPPED IMAGE for Hardware Step 1 ───────── */

#hardwareStep1 {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: calc(100vh - 140px); /* adjust 120-160px depending on your header height */
  overflow: hidden;            /* completely removes scrolling */
  box-sizing: border-box;
}

/* Keep bullet list short (scroll inside if it grows too tall) */
#hardwareStep1 ul {
  margin: 0 0 8px 20px;
  max-height: 18vh;
  overflow-y: auto;
}

/* Create a fixed frame for the image that crops instead of stretching */
#hardwareStep1 .screenshot {
  flex: 1;
  min-height: 250px;
  max-height: 25vh;           /* image area height relative to viewport */
  margin: 8px 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;           /* crop image if too tall */
  border-radius: 8px;
}

/* Image fills the frame (cropped if needed) */
#hardwareStep1 .screenshot img {
  width: 100%;
  height: 100%;
  object-fit: cover;          /* ⚠ crops the image so everything fits */
}

/* Nav buttons pinned at bottom of the visible area */
.nav-buttons {
  flex: 0 0 auto;
  margin-top: 8px;
}


    /* Nav buttons */
    .nav-buttons{ display:flex; justify-content:space-between; margin-top:20px; }
    button{ padding:12px 28px; font-size:16px; border:none; border-radius:50px; cursor:pointer; transition:transform .2s, background .3s; }
    button.next{ background:linear-gradient(135deg, #0078d7, #005bb5); color:#fff; }
    button.next:hover{ transform:scale(1.05); }
    button.prev{ background:transparent; color:#0078d7; border:2px solid #0078d7; }
    button.prev:hover{ background:#0078d7; color:#fff; }
    button.done{ background:#28a745; color:#fff; }

    .warning{ color:#b22222; font-weight:700; }
    .note{ color:#555; font-style:italic; }

    /* Bigger step titles vs. content */
.step h2{
  font-size: 26px;          /* was ~16–18 by default */
  line-height: 1.25;
  margin: 8px 0 6px;
  font-weight: 700;
}
.step p, .step li{
  font-size: 15px;
}
@media (min-width: 900px){
  .step h2{ font-size: 28px; }
}
    .wizard-header h2 {
  margin-right: 120px;             /* give the scaled logo some room */

}

  /* Reset (make sure only the active section/step shows) */
.wizard .section { display: none; }
.wizard .section.active { display: block; }
.wizard .section .step { display: none; }
.wizard .section .step.active { display: block; }

/* Remove any accidental global centering that may have been added earlier */
.section { align-items: initial; justify-content: initial; min-height: auto; }

  </style>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M09YL1Z3TN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M09YL1Z3TN');
</script>
</head>
<body>

  <!-- Welcome (optional; keep or remove) -->
  <div id="welcome">
    <div>
      <img src="Images/Logo.gif" alt="Company Logo" class="logo-anim"/>
      <h1>OMNIcheck Installation Guide</h1>
      <p>This wizard guides you through Hardware setup and Software installation.</p>
      <button class="start-btn" onclick="startGuide()">Start Installation Guide</button>
    </div>
  </div>

  <!-- Wizard -->
  <div class="wizard" id="wizard">
    <div class="wizard-header">
      <h2>OMNIcheck Installation Wizard</h2>
      <img src="Images/ator_blue.png" alt="Company Logo" class="logo-inline"/>
    </div>

    <!-- Tabs -->
    <div class="section-tabs">
      <button class="tab active" data-section="hardware" id="tabHardware">Hardware Setup</button>
      <button class="tab" data-section="contact" id="tabContact">Contact Support</button>
      <button class="tab" data-section="preinstall" id="tabPreinstall">Pre-Installation Warning</button>
      <button class="tab" data-section="software" id="tabSoftware">Software Installation</button>
      <button class="tab" data-section="legacy"   id="tabLegacy">Legacy Migration</button>
    </div>
    <!-- Progress -->
<div class="progress">
  <div class="progress-bar" id="progressBar"></div>
</div>


     <!-- ========= Hardware Section (sample—edit as you like) ========= -->
    <div class="section active" id="hardwareSection">
     <div class="step fit-step">
  <h2>Step 1: Unbox & Verify Contents</h2>
  <p><b>Make sure all items are present before you continue:</b></p>
  <ul>
    <li>OMNIcheck unit & Headform</li>
    <li>Power Assembly & Cord</li>
    <li>Two USB-A cables (<b>Grey</b> &amp; <b>Black</b>)</li>
    <li>USB-A Hub & USB-A Hub power cord</li>
    <li>Microphone</li>
    <li>Orifice</li>
  </ul>
  <div class="screenshot">
    <img src="Images/OMNICHECK.png" alt="OMNICheck with all accessories laid out">
  </div>
</div> 
      <!-- NEW: Step 2 (PC Requirements) -->
  <div class="step">
    <h2>Step 2: PC Requirements</h2>
    <p><b>Please confirm the PC meets the minimum specs:</b></p>
    <ul>
      <li><b>CPU:</b> Intel Core i5 (12th Gen) or equivalent</li>
      <li><b>RAM:</b> 16 GB</li>
      <li><b>Storage:</b> ≥ 2 GB free SSD space</li>
      <li><b>USB:</b> 3 total ports (≥ 1 USB-A)</li>
      <li><b>Network:</b> Internet access recommended</li>
      <li><b>OS:</b> Windows 10/11</li>
    </ul>
  </div>
      <div class="step">
  <h2>Step 3: Connections</h2>
  <ul>
    <li>Connect the <b>Black USB</b> cable from the <b>top rear USB port</b> on OMNIcheck → <b>PC USB port</b>.</li>
    <li>Connect the <b>Grey USB</b> cable from the <b>bottom rear USB port</b> on OMNIcheck → <b>USB Hub</b>.</li>
    <li>Plug the <b>USB Hub power cord</b> into a <b>PC USB port</b>.</li>
    <li>Connect accessories (e.g., <b>Microphone</b>, optional <b>RFID Reader</b>) to the <b>USB Hub</b>.</li>
  </ul>

  <div class="screenshot">
    <img src="Images/OC_SETUP.png" alt="OMNICheck cabling diagram showing grey and black USB connections, hub power, and accessories">
  </div>
</div>
    </div>

  
   
  <!-- ========= Contact Section ========= -->
<div class="section" id="contactSection">
  <div class="step active">
    <div class="contact-card">
      <h2>Report an Issue</h2>
      <p class="muted">Having trouble? Report your issue using the Links below.</p>

      <div class="contact-links">
        <div>
          <b>Software Bug:</b><br/>
          <a href="https://omnicheck.co/software-bug-reporting/#" target="_blank" rel="noopener noreferrer">Click Here</a>
        </div>
        <div>
          <b>Hardware Issue:</b><br/>
          <a href="https://omnicheck.co/hardware-issue-reporting/" target="_blank" rel="noopener noreferrer">Click Here</a>
        </div>
      </div>
    </div>
  </div>
</div>


      <!-- ========= Software Section (11 steps as requested) ========= -->
     <div class="section" id="softwareSection">
      <!-- 1 -->
      <div class="step active">
        <h2>Step 1: Run Installer as Administrator</h2>
        <p>Right-click the installer and choose <b>Run as administrator</b>.</p>
        <div class="screenshot"><img src="Images/1.png" alt="Run as administrator"></div>
      </div>
      <!-- 2 -->
      <div class="step">
        <h2>Step 2: Destination Directory</h2>
        <p>Select Install locations, then click <b>Next</b>.</p>
        <div class="screenshot"><img src="Images/2.png" alt="Destination Directory"></div>
      </div>
      <!-- 3 -->
      <div class="step">
        <h2>Step 3: License Agreement (ATOR Labs)</h2>
        <p>Review and accept the ATOR Labs license agreement. Click <b>Next</b> to Continue.</p>
        <div class="screenshot"><img src="Images/3.jpeg" alt="OMNICHECK License Agreement"></div>
      </div>
      <!-- 4 -->
      <div class="step">
        <h2>Step 4: License Agreement (National Instruments)</h2>
        <p>Review and Accept the National Instruments software license agreement. Click <b>Next</b> to Continue.</p>
        <div class="screenshot"><img src="Images/4.png" alt="NI License Agreement"></div>
      </div>
      <!-- 5 -->
      <div class="step">
        <h2>Step 5: Start Installation</h2>
        <p>Review the summary and click <b>Next</b> to begin.</p>
        <div class="screenshot"><img src="Images/5.png" alt="Start Installation"></div>
      </div>
      <!-- 6 -->
      <div class="step">
        <h2>Step 6: Installation Complete (Base Installer)</h2>
        <p>Base Installer has finished updating your system. Click <b>Next</b>.</p>
        <div class="screenshot"><img src="Images/6.png" alt="Installation Complete"></div>
      </div>
      <!-- 7 -->
      <div class="step">
        <h2>Step 7: OMNIcheck Database Runner – Ready to Install</h2>
        <p>Click <b>Install</b> to continue with OMNIcheck Database Runner.</p>
        <div class="screenshot"><img src="Images/7.png" alt="Database Runner Ready"></div>
      </div>
      <!-- 8 -->
      <div class="step">
        <h2>Step 8: Installing PostgreSQL & Components</h2>
       <p class="note"><b> Do not exit from the process.</b> Please wait as PostgreSQL,psqlODBC Installs. It may take 45 minutes to complete the Installation Process.</p>
        <div class="screenshot"><img src="Images/8.png" alt="Installing Components"></div>
      </div>
      <!-- 9 -->
      <div class="step">
        <h2>Step 9: Driver Installation(ODBC)</h2>
       <p class="note">Press <b>any key to continue</b> to next backup process.</p>
        <div class="screenshot"><img src="Images/9.png" alt="ODBC Driver Install"></div>
      </div>
      <!-- 10 -->
      <div class="step">
        <h2>Step 10: Restore Databases</h2>
      <p class="note">Press <b>any key to continue </b>and Finish the Backup Process.</p>
        <div class="screenshot"><img src="Images/10.png" alt="Restore Databases"></div>
      </div>
      <!-- 11 (placeholder) -->
      <div class="step">
        <h2>Step 11: Finalize & Finish</h2>
        <p class="note"><b>Click on Finish</b> to Complete the Installation Process.</p>
        <div class="screenshot"><img src="Images/11.png" alt="Final Step (placeholder)"></div>
      </div>
    </div>
    <!-- ========= Legacy Database Migration Section ========= -->

  <!-- Step 1 -->
    <div class="section active" id="legacySection">
  <div class="step active">
    <h2>Step 1: Restore the Backup Using the Script</h2>
    <p><b>Purpose:</b> Restore the legacy data into the new PostgreSQL 17 instance.</p>
    <ul>
      <li>Copy <b>yor_Legacy_database_name.backup</b> into <b>C:\omicheck\Legacy\</b></li>
      <li>Double-click <b>legacy_backupscript.bat</b> to run it</li>
      <li>The script automatically begins restoration</li>
      <li>Wait for <b>“Restore completed successfully.”</b></li>
    </ul>
    <div class="screenshot">
      <!-- Replace with your real image file (command window running pg_restore) -->
      <img src="Images/14.png" alt="Running legacy_backupscript.bat restoring database">
    </div>
    <p class="warning"> Do not close the window while the process runs.</p>
  </div>

  <!-- Step 2 -->
  <div class="step">
    <h2>Step 2: Import the Legacy Data into OMNICheck</h2>
    <p><b>Purpose:</b> Import the restored database into the OMNICheck software.</p>
    <ol>
      <li>Open <b>OMNICheck NFPA Start Menu.vi</b></li>
      <li>Verify <b>OMNI Connected</b> (green light)</li>
      <li>Click the <b>⚙️</b> next to <b>Active Database</b> to open configuration</li>
      <li>In <b>Legacy Database</b>, enter the restored database name (e.g., <b>legacy_omnicheck_db</b>)</li>
      <li>Ensure <b>Active Asset Database</b> points to your current DB (e.g., <b>oc_test1</b>)</li>
      <li>Click <b>Import Database</b> and wait for success</li>
    </ol>
    <div class="screenshot">
      <!-- You already have these two screenshots -->
      <img src="Images/Screenshot_2025-10-30_152121.png" alt="OMNICheck main screen with OMNI Connected">
    </div>
    <div class="screenshot">
      <img src="Images/Screenshot_2025-10-30_152134.png" alt="Postgre Database Configuration with legacy import option">
    </div>
    <p class="note">Your OMNICheck installation now includes all legacy data.</p>
  </div>
</div>

  <!-- ========= Pre-Installation Warning Section ========= -->
<div class="section" id="preinstallSection">
  <div class="step active">
    <div class="warning-card">
      <h2>⚠️ Important Notice Before Software Installation</h2>
      <p class="muted"><b>Please read this carefully before proceeding.</b></p>
      <ul>
        <li>Installing or reinstalling <b>PostgreSQL</b> on a machine that already has an existing PostgreSQL installation may <b>overwrite</b> or <b>corrupt existing databases</b>.</li>
        <li>If you have an existing PostgreSQL database, make sure you have created a <b>backup (.backup file)</b> using <b>pgAdmin</b> before continuing.</li>
        <li>Store your backup safely in a separate folder (recommended: <b>C:\Backup</b>).</li>
        <li><b>Only continue when your backup is confirmed and verified.</b></li>
      </ul>
    </div>
  </div>

 <!-- Step  -->
  <div class="step">
    <h2>Step 1 : Create a .backup File Using pgAdmin</h2>
    <p><b>Purpose:</b> Export your previous (legacy) database used until now from the older PostgreSQL system.</p>
    <ul>
      <li>On your legacy machine, open <b>pgAdmin 4</b></li>
      <li>Right-click your <b>previous (legacy) database</b> → <b>Backup…</b></li>
      <li>Click the folder icon on the right side of the filename field
      <li>Choose <b>Custom (.backup)</b> as the format</li>
      <li>Save as <b>C:\Program Files\Legacy-DB\OMNICheck_Legacy.backup</b></li>
      <li>Click <b>Backup</b> and wait for confirmation</li>
    </ul>
    <div class="screenshot">
      <!-- Replace with your real image file (pgAdmin Backup dialog) -->
      <img src="Images/13.png" alt="pgAdmin backup dialog selecting Custom .backup format">
    </div>
    <p class="note">You now have a portable <b>.backup</b> file ready for migration.</p>
  </div>
  </div>


    <!-- Nav -->
    <div class="nav-buttons">
      <button class="prev" id="prevBtn">Previous</button>
      <button class="next" id="nextBtn">Next</button>
    </div>
  </div>
<script>
  // --- Element lookups
  const wizard      = document.getElementById('wizard');
  const welcome     = document.getElementById('welcome');
  const progressBar = document.getElementById('progressBar');
  const nextBtn     = document.getElementById('nextBtn');
  const prevBtn     = document.getElementById('prevBtn');

  // Tabs
  const tabHardware   = document.getElementById('tabHardware');
  const tabContact    = document.getElementById('tabContact');
  const tabPreinstall = document.getElementById('tabPreinstall');  
  const tabSoftware   = document.getElementById('tabSoftware');
  const tabLegacy     = document.getElementById('tabLegacy');

  // Sections (keys MUST match ids exactly)
  const sections = {
    hardware:   document.getElementById('hardwareSection'),
    legacy:     document.getElementById('legacySection'),
    contact:    document.getElementById('contactSection'),
    preinstall: document.getElementById('preinstallSection'), 
    software:   document.getElementById('softwareSection')
  };

  // Flow across tabs (choose the order you want)
  const sectionOrder = ['hardware',  'contact', 'preinstall', 'software','legacy']; 

  // Remember last step per section
  const stepIndexBySection = { hardware: 0,  contact: 0, preinstall: 0, software: 0,legacy: 0 }; 
  // --- State
  let currentSection   = 'hardware';
  let currentStepIndex = 0;
  let userClickedTab   = false;

  function stepsIn(section = currentSection){
    return sections[section].querySelectorAll('.step');
  }

  function showHideSections(){
    // Show only the current section
    Object.keys(sections).forEach(k => {
      sections[k].classList.toggle('active', k === currentSection);
    });
    // Set active tab
    tabHardware .classList.toggle('active', currentSection === 'hardware');
    tabContact  .classList.toggle('active', currentSection === 'contact');
    tabPreinstall.classList.toggle('active', currentSection === 'preinstall'); 
    tabSoftware .classList.toggle('active', currentSection === 'software');
    tabLegacy   .classList.toggle('active', currentSection === 'legacy');
  }

  // Pretty labels for "Go to …" button
  const sectionLabels = {
    hardware:   'Hardware Setup',
    legacy:     'Legacy Migration',
    contact:    'Contact Support',
    preinstall: 'Pre-Installation Warning',
    software:   'Software Installation'
  };
  const cap = s => s.charAt(0).toUpperCase() + s.slice(1);
  function labelFor(sec){ return sectionLabels[sec] || cap(sec); }

  function activateStep() {
    showHideSections();

    const steps = stepsIn();
    // Guard if a section has no steps
    if (!steps.length) {
      progressBar && (progressBar.style.width = '0%');
      nextBtn.disabled = true;
      prevBtn.disabled = true;
      return;
    }

    steps.forEach((s, i) => s.classList.toggle('active', i === currentStepIndex));
    if (progressBar) {
      progressBar.style.width = ((currentStepIndex + 1) / steps.length) * 100 + '%';
    }

    // Prev disabled only at very first step overall
    const disablePrev = (currentSection === 'hardware' && currentStepIndex === 0);
    prevBtn.disabled = disablePrev;
    prevBtn.style.opacity = disablePrev ? 0.5 : 1;

    const atLast = currentStepIndex === steps.length - 1;

    if (atLast) {
      const idx = sectionOrder.indexOf(currentSection);
      const nextSection = sectionOrder[idx + 1];

      if (nextSection) {
        nextBtn.textContent = `Go to ${labelFor(nextSection)}`;
        nextBtn.classList.remove('done');
        nextBtn.classList.add('next');
        nextBtn.onclick = () => {
          stepIndexBySection[currentSection] = currentStepIndex;
          setSection(nextSection);
        };
      } else {
        // Final section
        nextBtn.textContent = 'Done';
        nextBtn.classList.remove('next');
        nextBtn.classList.add('done');
        nextBtn.onclick = () => alert('Installation walkthrough complete!');
      }
    } else {
      nextBtn.textContent = 'Next';
      nextBtn.classList.add('next');
      nextBtn.classList.remove('done');
      nextBtn.onclick = nextStep;
    }
  }

  function setSection(name){
    if (!sections[name] || name === currentSection) return;

    // remember current position
    stepIndexBySection[currentSection] = currentStepIndex;

    currentSection = name;

    // If user clicked Hardware explicitly, always start from step 1
    if (name === 'hardware' && userClickedTab) {
      currentStepIndex = 0;
      stepIndexBySection.hardware = 0;
    } else {
      currentStepIndex = stepIndexBySection[name] || 0;
    }

    userClickedTab = false;
    activateStep();
  }

  function nextStep(){
    const steps = stepsIn();
    if (currentStepIndex < steps.length - 1){
      currentStepIndex++;
      stepIndexBySection[currentSection] = currentStepIndex;
      activateStep();
      return;
    }
    // last step in this section → move to next section
    const idx = sectionOrder.indexOf(currentSection);
    const nextSection = sectionOrder[idx + 1];
    if (nextSection){
      stepIndexBySection[currentSection] = currentStepIndex;
      currentSection = nextSection;
      currentStepIndex = 0;
      activateStep();
    }
  }

  function prevStep(){
    const steps = stepsIn();
    if (currentStepIndex > 0){
      currentStepIndex--;
      stepIndexBySection[currentSection] = currentStepIndex;
      activateStep();
      return;
    }
    // first step in this section → go to previous section's last step (if any)
    const idx = sectionOrder.indexOf(currentSection);
    const prevSection = sectionOrder[idx - 1];
    if (prevSection){
      const prevSteps = stepsIn(prevSection);
      currentSection = prevSection;
      currentStepIndex = Math.max(0, prevSteps.length - 1);
      activateStep();
    }
  }

  // --- Listeners
  tabHardware  .addEventListener('click', () => { userClickedTab = true; setSection('hardware');   });
  tabLegacy    .addEventListener('click', () => { userClickedTab = true; setSection('legacy');     });
  tabContact   .addEventListener('click', () => { userClickedTab = true; setSection('contact');    });
  tabPreinstall.addEventListener('click', () => { userClickedTab = true; setSection('preinstall'); }); 
  tabSoftware  .addEventListener('click', () => { userClickedTab = true; setSection('software');   });

  prevBtn.addEventListener('click', prevStep);

  // --- Start from welcome
  function startGuide(){
    if (welcome) welcome.style.display = 'none';
    wizard.style.display = 'block';
    currentSection = 'hardware';
    currentStepIndex = 0;
    stepIndexBySection.hardware = 0;
    activateStep();
  }
  window.startGuide = startGuide;

  // If you don’t use the welcome screen, show wizard immediately:
  if (!welcome){ wizard.style.display = 'block'; activateStep(); }
</script>
</body>
</html>





























































































